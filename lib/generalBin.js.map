{"version":3,"sources":["../src/generalBin.js"],"names":["path","require","meow","spawn","isString","isUndefined","getDescription","module","exports","binName","isRelay","alias","bs","m","i","v","r","d","a","h","input","flags","release","verbose","analyze","debug","mobx","isomorphic","relay","sync","typeScript","rhl","TOOLS_DIR","resolve","__dirname","actionName","length","actionFiles","start","build","process","env","NODE_ENV","BUILD_TOOLS_VERBOSE","BUILD_TOOLS_ANALYZE","WEBPACK_WATCH","WEBPACK_DEBUG","ENABLED_MOBX_TOOLS","ENABLED_ISOMORPHIC","ENABLED_RELAY","ENABLED_BROWSER_SYNC","ENABLED_TYPE_SCRIPT","ENABLED_RHL","result","stdio","signal","console","log","exit","status"],"mappings":"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","file":"generalBin.js","sourcesContent":["'use strict';\nconst path = require('path');\nconst meow = require('meow');\nconst spawn = require('cross-spawn');\nconst {isString, isUndefined} = require('@borodindmitriy/utils/lib');\nconst getDescription = require('./configs/utils/getDescription');\n\nmodule.exports = (binName = 'react-app', isRelay = false) => {\n  const {input, flags: {release, verbose, analyze, debug, mobx, isomorphic, relay, sync, typeScript, rhl}} = meow(\n    getDescription(binName, isRelay),\n    {\n      alias: {\n        bs: 'sync',\n        m: 'mobx',\n        i: 'isomorphic',\n        v: 'verbose',\n        r: 'release',\n        d: 'debug',\n        a: 'analyze',\n        h: 'help',\n      },\n    },\n  );\n\n  const TOOLS_DIR = path.resolve(__dirname, '../lib/tools', binName);\n  const actionName = input.length === 0 ? 'start' : input[0];\n  const actionFiles = {\n    start: path.resolve(TOOLS_DIR, 'start.js'),\n    build: path.resolve(TOOLS_DIR, 'build.js'),\n  };\n\n  process.env.NODE_ENV = !release ? 'development' : 'production';\n  process.env.BUILD_TOOLS_VERBOSE = !isUndefined(verbose) ? verbose : false;\n  process.env.BUILD_TOOLS_ANALYZE = !isUndefined(analyze) ? analyze : false;\n  process.env.WEBPACK_WATCH = actionName === 'start';\n  process.env.WEBPACK_DEBUG = !isUndefined(debug) ? debug : false;\n  process.env.ENABLED_MOBX_TOOLS = !isUndefined(mobx) ? mobx : false;\n  process.env.ENABLED_ISOMORPHIC = !isUndefined(isomorphic) ? isomorphic : false;\n  process.env.ENABLED_RELAY = !isUndefined(relay) ? relay : false;\n  process.env.ENABLED_BROWSER_SYNC = !isUndefined(sync) ? sync : false;\n  process.env.ENABLED_TYPE_SCRIPT = !isUndefined(typeScript) ? typeScript : false;\n  process.env.ENABLED_RHL = !isUndefined(rhl) ? rhl : false;\n\n  if (isString(actionFiles[actionName])) {\n    const result = spawn.sync('node', [actionFiles[actionName]], {stdio: 'inherit'});\n\n    if (result.signal) {\n      if (result.signal === 'SIGKILL') {\n        console.log(\n          'The build failed because the process exited too early. ' +\n          'This probably means the system ran out of memory or someone called ' +\n          '`kill -9` on the process.',\n        );\n        process.exit(1);\n      } else if (result.signal === 'SIGTERM') {\n        console.log(\n          'The build failed because the process exited too early. ' +\n          'Someone might have called `kill` or `killall`, or the system could ' +\n          'be shutting down.',\n        );\n        process.exit(1);\n      }\n      process.exit(0);\n    }\n    process.exit(result.status);\n\n  } else {\n    console.log('Unknown action \"' + actionName + '\".');\n    console.log('Perhaps you need to update react-app?');\n    process.exit(1);\n  }\n};\n"]}